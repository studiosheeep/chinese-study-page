<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>単語辞書の編集</title>

  <style>
    body {
      font-family: system-ui, sans-serif;
      padding: 20px;
      background: #f3f4f6;
      color: #111827;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .section {
      background: white;
      padding: 16px;
      border-radius: 8px;
      max-width: 600px;
      margin: 0 auto 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }

    label { display:block; margin: 8px 0 4px; }
    input {
      width: 100%;
      padding: 6px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
    }

    button {
      padding: 6px 10px;
      margin-top: 10px;
      border-radius: 6px;
      border: 1px solid #d1d5db;
      background: white;
      cursor: pointer;
    }
    button:hover {
      background: #e5e7eb;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      border-bottom: 1px solid #e5e7eb;
      padding: 6px;
      font-size: 14px;
    }

    .remove-btn {
      background: #ef4444;
      border-color: #dc2626;
      color: white;
    }
  </style>
</head>

<body>
  <h1>単語辞書の編集</h1>

  <div class="section">
    <h2 style="font-size:16px;">新しい単語を追加</h2>

    <label>中国語（漢字）</label>
    <input id="wordInput" placeholder="例：萨菲罗斯">

    <label>ピンイン</label>
    <input id="pinyinInput" placeholder="例：sà fēi luó sī">

    <label>日本語訳</label>
    <input id="jaInput" placeholder="例：セフィロス">

    <button id="addBtn">追加する</button>
  </div>

  <div class="section">
    <h2 style="font-size:16px;">登録済みの単語</h2>

    <table>
      <thead>
        <tr><th>漢字</th><th>ピンイン</th><th>日本語</th><th></th></tr>
      </thead>
      <tbody id="dictTable"></tbody>
    </table>
  </div>

<script>
  // localStorage に保存するキー
  const STORAGE_KEY = "customCnDict";

  // 読み込み
  function loadDict() {
    try {
      const data = localStorage.getItem(STORAGE_KEY);
      return data ? JSON.parse(data) : {};
    } catch {
      return {};
    }
  }

  // 保存
  function saveDict(dict) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(dict));
  }

  // テーブルに反映
  function refreshTable() {
    const dict = loadDict();
    const tbody = document.getElementById("dictTable");
    tbody.innerHTML = "";

    for (const [word, info] of Object.entries(dict)) {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${word}</td>
        <td>${info.pinyin}</td>
        <td>${info.ja}</td>
        <td><button class="remove-btn" data-word="${word}">削除</button></td>
      `;
      tbody.appendChild(tr);
    }

    // 削除ボタン
    document.querySelectorAll(".remove-btn").forEach(btn => {
      btn.onclick = () => {
        const w = btn.getAttribute("data-word");
        const dict = loadDict();
        delete dict[w];
        saveDict(dict);
        refreshTable();
      };
    });
  }

  // 追加処理
  document.getElementById("addBtn").onclick = () => {
    const w = document.getElementById("wordInput").value.trim();
    const p = document.getElementById("pinyinInput").value.trim();
    const j = document.getElementById("jaInput").value.trim();

    if (!w || !p || !j) {
      alert("すべて入力してください");
      return;
    }

    const dict = loadDict();
    dict[w] = { pinyin: p, ja: j };
    saveDict(dict);
    refreshTable();

    // 入力欄クリア
    document.getElementById("wordInput").value = "";
    document.getElementById("pinyinInput").value = "";
    document.getElementById("jaInput").value = "";
  };

  refreshTable();
</script>
</body>
</html>
